# ğŸŸ äºŒæ‰‹äº¤æ˜“å¹³å°

---

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®ä¸ºä¸€æ¬¾äºŒæ‰‹ç‰©å“äº¤æ˜“å¹³å°ï¼ŒåŸºäºå‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œç”¨æˆ·å¯å‘å¸ƒå•†å“ã€æµè§ˆå•†å“ã€ç•™è¨€äº¤æµã€æ”¶è—æ„Ÿå…´è¶£å•†å“ï¼Œå¹¶æ”¯æŒåŸºç¡€äº¤æ˜“åŠŸèƒ½ï¼Œå«åå°ç®¡ç†æ¨¡å—ï¼ˆå¯é€‰ï¼‰ã€‚æ–°å¢AIæ™ºèƒ½æœåŠ¡æ¨¡å—ï¼Œç”¨æˆ·å¯é€šè¿‡æ™ºèƒ½å¯¹è¯è·å–ä¸ªæ€§åŒ–å•†å“æ¨èã€‚ç³»ç»Ÿè®¾è®¡ç®€æ´ã€åŠŸèƒ½å®Œæ•´ï¼Œé€‚åˆä½œä¸ºé«˜æ ¡æ¯•è®¾ã€è¯¾ç¨‹è®¾è®¡ã€ä¸ªäººå®æˆ˜é¡¹ç›®åŠä¸­å°å‹å•†ä¸šåŸå‹å¼€å‘ã€‚

---

## äºŒã€æ ¸å¿ƒæŠ€æœ¯æ ˆ

| å±‚æ¬¡ | æŠ€æœ¯é€‰å‹                                                                                                                |
|----|---------------------------------------------------------------------------------------------------------------------|
| åç«¯ | Spring Boot 3.4.6ã€MyBatis-Plusã€MySQL 8.xã€Redisã€Spring Security + JWTã€Lombokã€Knife4jï¼ˆSwaggerå¢å¼ºï¼‰ã€æœ¬åœ°æ–‡ä»¶å­˜å‚¨ã€DeepSeek AIæ¥å£ |
| å‰ç«¯ | Vue 3.5.13ã€TypeScriptã€Vite 6.3.5ã€Pinia 3.0.3ã€Vue Router 4.5.1ã€Axios 1.10.0ã€Element Plus 2.10.2                      |                                                       |
| å…¶ä»– | Mavenã€Nginxã€Postman                                                                                                 |

---

## ä¸‰ã€ä¸»è¦åŠŸèƒ½æ¨¡å—

### 1. ç”¨æˆ·æ¨¡å—

- ç”¨æˆ·æ³¨å†Œã€ç™»å½•ï¼ˆJWTè®¤è¯ï¼Œæ”¯æŒä»¤ç‰Œåˆ·æ–°æœºåˆ¶ï¼Œå¢å¼ºä»¤ç‰ŒéªŒè¯å®‰å…¨æ€§ï¼‰

- ä¸ªäººèµ„æ–™ç®¡ç†ï¼ˆæ˜µç§°ã€å¤´åƒã€æ‰‹æœºå·ç­‰ï¼Œå«æ‰‹æœºå·æ ¼å¼éªŒè¯ï¼‰

- æˆ‘çš„å‘å¸ƒã€æ”¶è—ã€äº¤æ˜“è®°å½•

- å¤´åƒä¸Šä¼ 

- å®‰å…¨ç™»å‡ºåŠŸèƒ½ï¼ˆæ”¯æŒä»¤ç‰Œé»‘åå•ç®¡ç†ï¼Œç¡®ä¿é€€å‡ºåä»¤ç‰Œç«‹å³å¤±æ•ˆï¼‰

- å¯†ç å®‰å…¨ç­–ç•¥ï¼ˆè‡³å°‘8ä½ï¼ŒåŒ…å«å­—æ¯å’Œæ•°å­—ï¼Œå¢å¼ºå¯†ç åŠ å¯†å­˜å‚¨ï¼‰

- ç”¨æˆ·ä¿¡æ¯ç¼“å­˜ä¼˜åŒ–ï¼ˆRedisç¼“å­˜å‡è½»æ•°æ®åº“å‹åŠ›ï¼Œæå‡ç³»ç»Ÿå“åº”é€Ÿåº¦ï¼‰

### 2. å•†å“æ¨¡å—

- å‘å¸ƒäºŒæ‰‹å•†å“ï¼ˆä¸»å›¾ä¸Šä¼ ã€å¤šå›¾ä¸Šä¼ ï¼‰

- å•†å“æµè§ˆã€æ¨¡ç³Šæœç´¢

- å•†å“è¯¦æƒ…æŸ¥çœ‹

### 3. äº¤æ˜“æ¨¡å—

- æ¨¡æ‹Ÿè®¢å•ä¸‹å•ã€äº¤æ˜“è®¢å•æŸ¥çœ‹

### 4. ç•™è¨€/æ”¶è—æ¨¡å—

- ä¹°å®¶ç•™è¨€ / å–å®¶å›å¤
- æ”¶è—/å–æ¶ˆæ”¶è—å•†å“

### 5. AIæ™ºèƒ½æœåŠ¡æ¨¡å—

- ç”¨æˆ·åœ¨é¦–é¡µæ‰“å¼€èŠå¤©çª—å£ï¼Œä¸AIæ™ºèƒ½åŠ©æ‰‹å¯¹è¯

- AIå›å¤ç­‰å¾…æ—¶çš„æ¶ˆæ¯æ°”æ³¡åŠ¨ç”»å’Œloadingé—ªç‚¹æ•ˆæœï¼Œè¥é€ AIâ€œæ€è€ƒâ€çš„è§†è§‰ä½“éªŒ

- AIæ ¹æ®ç”¨æˆ·æè¿°éœ€æ±‚ï¼Œæ™ºèƒ½æ¨èåŒ¹é…å•†å“

- AIå¯¹è¯æ¥å£æ”¯æŒå¤šè½®å¯¹è¯ï¼Œæå‡äº¤äº’ä½“éªŒ

---

## å››ã€é¡¹ç›®ç›®å½•ç»“æ„

### åç«¯ï¼ˆ`secondhand_backend`ï¼‰

```
secondhand_backend
â”‚  .gitignore
â”‚  pom.xml
â””â”€â”€ src\
    â””â”€â”€ main\
        â”œâ”€â”€ java/com/seateam/secondhand_system/
        â”‚   â”œâ”€â”€ common  # å…¬å…±ç±»
        â”‚   â”‚   â”œâ”€â”€ config  # é…ç½®ç±»(CorsConfigã€SecurityConfigç­‰)
        â”‚   â”œâ”€â”€ ai  # AIæœåŠ¡ç›¸å…³ç±»(DeepSeekApiClientç­‰)
        â”‚   â”œâ”€â”€ utils  # å·¥å…·ç±»(FileUploadUtilsç­‰)
        â”‚   â”‚   â””â”€â”€ exception  # å¼‚å¸¸å¤„ç†ç±»
        â”‚   â”œâ”€â”€ controller/  # REST API æ§åˆ¶å™¨
        â”‚   â”œâ”€â”€ entity/  # å®ä½“ç±»
        â”‚   â”œâ”€â”€ mapper/  # MyBatis-Plus æ˜ å°„æ¥å£
        â”‚   â”œâ”€â”€ service/  # ä¸šåŠ¡é€»è¾‘æ¥å£åŠå®ç°
        â”‚   â””â”€â”€ SecondhandSystemApplication.java # å¯åŠ¨ç±»
        â””â”€â”€ resources/
            â”œâ”€â”€ application.yml  # é…ç½®æ–‡ä»¶
            â”œâ”€â”€ mapper/*.xml  # MyBatis XMLæ–‡ä»¶
            â””â”€â”€ static/  # é™æ€èµ„æº
```

### å‰ç«¯ï¼ˆ`secondhand_frontend`ï¼‰

```
secondhand_frontend
â”‚  .env
â”‚  .gitignore
â”‚  index.html
â”‚  package-lock.json
â”‚  package.json
â”œâ”€â”€ public\
â”‚  â””â”€â”€ vite.svg
â””â”€â”€ src\
    â”œâ”€â”€ App.vue
    â”œâ”€â”€ api\  # Axioså°è£…ä¸æ¥å£è¯·æ±‚
    â”‚   â”œâ”€â”€ ai.ts  # AIæœåŠ¡æ¥å£å°è£…
    â”‚   â”œâ”€â”€ user.ts
    â”‚   â”œâ”€â”€ goods.ts
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ assets\  # é™æ€èµ„æº
    â”œâ”€â”€ components\  # å…¬å…±ç»„ä»¶
    â”‚   â”œâ”€â”€ AiChat.vue  # AIèŠå¤©å¯¹è¯æ¡†ç»„ä»¶ï¼Œæ”¯æŒæ¶ˆæ¯å±•ç¤ºã€å•†å“æ¨èå¡ç‰‡å’ŒMarkdownæ¸²æŸ“
    â”‚   â”œâ”€â”€ ImageUpload.vue  # å›¾ç‰‡ä¸Šä¼ ç»„ä»¶ï¼Œæ”¯æŒå¤šå›¾ä¸Šä¼ ã€é¢„è§ˆå’Œåˆ é™¤
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ main.ts  # åº”ç”¨å…¥å£æ–‡ä»¶
    â”œâ”€â”€ pages\  # è·¯ç”±é¡µé¢ç»„ä»¶
    â”œâ”€â”€ router\  # Vue Router è·¯ç”±é…ç½®
    â”‚   â””â”€â”€ index.ts
    â”œâ”€â”€ store\  # Pinia çŠ¶æ€ç®¡ç†
    â”‚   â”œâ”€â”€ ai.ts  # AIç›¸å…³çŠ¶æ€ç®¡ç†
    â”‚   â”œâ”€â”€ user.ts
    â”‚   â”œâ”€â”€ goods.ts
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ style.css
    â”œâ”€â”€ views\  # è§†å›¾ç»„ä»¶
    â””â”€â”€ vite-env.d.ts
```

## äº”ã€æ•°æ®åº“è®¾è®¡

### 1. ç”¨æˆ·è¡¨ï¼ˆ`user`ï¼‰

| å­—æ®µå         | ç±»å‹                                 | å…è®¸ä¸ºç©º | é»˜è®¤å€¼               | è¯´æ˜                                     |
|-------------|------------------------------------|------|-------------------|----------------------------------------|
| id          | BIGINT AUTO_INCREMENT              | å¦    | â€”                 | ä¸»é”®ï¼Œè‡ªå¢                                  |
| username    | VARCHAR(50)                        | å¦    | â€”                 | ç”¨æˆ·åï¼Œå”¯ä¸€çº¦æŸ                               |
| password    | VARCHAR(255)                       | å¦    | â€”                 | å¯†ç ï¼ˆåŠ å¯†å­˜å‚¨ï¼‰                               |
| avatar      | VARCHAR(255)                       | æ˜¯    | NULL              | å¤´åƒURLåœ°å€                                |
| phone       | VARCHAR(20)                        | æ˜¯    | NULL              | æ‰‹æœºå·                                    |
| role        | ENUM('user', 'admin', 'merchants') | å¦    | 'user'            | ç”¨æˆ·è§’è‰²ï¼ˆuser-æ™®é€šç”¨æˆ·ï¼Œadmin-ç®¡ç†å‘˜ï¼Œmerchants-å•†å®¶ï¼‰ |
| create_time | DATETIME                           | å¦    | CURRENT_TIMESTAMP | æ³¨å†Œæ—¶é—´                                   |

---

### 2. å•†å“è¡¨ï¼ˆ`goods`ï¼‰

| å­—æ®µå         | ç±»å‹                    | å…è®¸ä¸ºç©º | é»˜è®¤å€¼               | è¯´æ˜             |
|-------------|-----------------------|------|-------------------|----------------|
| id          | BIGINT AUTO_INCREMENT | å¦    | â€”                 | ä¸»é”®ï¼Œè‡ªå¢          |
| user_id     | BIGINT                | å¦    | â€”                 | å‘å¸ƒç”¨æˆ·ID         |
| title       | VARCHAR(100)          | å¦    | â€”                 | å•†å“æ ‡é¢˜           |
| description | TEXT                  | æ˜¯    | NULL              | å•†å“æè¿°           |
| price       | DECIMAL(10,2)         | å¦    | â€”                 | å•†å“ä»·æ ¼           |
| category    | VARCHAR(50)           | æ˜¯    | NULL              | å•†å“åˆ†ç±»           |
| status      | TINYINT               | å¦    | 0                 | å•†å“çŠ¶æ€ï¼š0-åœ¨å”®ï¼Œ1-å·²å”® |
| create_time | DATETIME              | å¦    | CURRENT_TIMESTAMP | å‘å¸ƒæ—¶é—´           |

---

### 3. æ”¶è—è¡¨ï¼ˆ`favorite`ï¼‰

| å­—æ®µå      | ç±»å‹                    | å…è®¸ä¸ºç©º | é»˜è®¤å€¼ | è¯´æ˜     |
|----------|-----------------------|------|-----|--------|
| id       | BIGINT AUTO_INCREMENT | å¦    | â€”   | ä¸»é”®ï¼Œè‡ªå¢  |
| user_id  | BIGINT                | å¦    | â€”   | æ”¶è—ç”¨æˆ·ID |
| goods_id | BIGINT                | å¦    | â€”   | å•†å“ID   |

---

### 4. ç•™è¨€è¡¨ï¼ˆ`message`ï¼‰

| å­—æ®µå           | ç±»å‹                    | å…è®¸ä¸ºç©º | é»˜è®¤å€¼               | è¯´æ˜         |
|---------------|-----------------------|------|-------------------|------------|
| id            | BIGINT AUTO_INCREMENT | å¦    | â€”                 | ä¸»é”®ï¼Œè‡ªå¢      |
| goods_id      | BIGINT                | å¦    | â€”                 | å…³è”å•†å“ID     |
| user_id       | BIGINT                | å¦    | â€”                 | ç•™è¨€ç”¨æˆ·ID     |
| content       | TEXT                  | å¦    | â€”                 | ç•™è¨€å†…å®¹       |
| reply_content | TEXT                  | æ˜¯    | NULL              | å–å®¶å›å¤å†…å®¹ï¼ˆå¯ç©ºï¼‰ |
| reply_time    | DATETIME              | æ˜¯    | NULL              | å–å®¶å›å¤æ—¶é—´ï¼ˆå¯ç©ºï¼‰ |
| create_time   | DATETIME              | å¦    | CURRENT_TIMESTAMP | ç•™è¨€æ—¶é—´       |

---

### 5. è®¢å•è¡¨ï¼ˆ`order`ï¼‰

| å­—æ®µå         | ç±»å‹                    | å…è®¸ä¸ºç©º | é»˜è®¤å€¼               | è¯´æ˜               |
|-------------|-----------------------|------|-------------------|------------------|
| id          | BIGINT AUTO_INCREMENT | å¦    | â€”                 | ä¸»é”®ï¼Œè‡ªå¢            |
| buyer_id    | BIGINT                | å¦    | â€”                 | ä¹°å®¶ID             |
| seller_id   | BIGINT                | å¦    | â€”                 | å–å®¶ID             |
| goods_id    | BIGINT                | å¦    | â€”                 | å•†å“ID             |
| price       | DECIMAL(10,2)         | å¦    | â€”                 | æˆäº¤ä»·æ ¼             |
| status      | TINYINT               | å¦    | 0                 | è®¢å•çŠ¶æ€ï¼š0-æœªä»˜æ¬¾ï¼Œ1-å·²å®Œæˆ |
| create_time | DATETIME              | å¦    | CURRENT_TIMESTAMP | ä¸‹å•æ—¶é—´             |

---

### 6. AIå¯¹è¯è¡¨ï¼ˆ`ai_chat`ï¼‰

| å­—æ®µå         | ç±»å‹                    | å…è®¸ä¸ºç©º | é»˜è®¤å€¼               | è¯´æ˜                     |
|-------------|-----------------------|------|-------------------|------------------------|
| id          | BIGINT AUTO_INCREMENT | å¦    | â€”                 | ä¸»é”®ï¼Œè‡ªå¢                  |
| user_id     | BIGINT                | å¦    | â€”                 | ç”¨æˆ·ID                   |
| session_id  | VARCHAR(100)          | å¦    | â€”                 | å¯¹è¯ä¼šè¯IDï¼ˆå¤šè½®å¯¹è¯æ ‡è¯†ï¼‰         |
| message     | TEXT                  | å¦    | â€”                 | ç”¨æˆ·è¾“å…¥å†…å®¹                 |
| response    | TEXT                  | æ˜¯    | NULL              | AIå›å¤å†…å®¹ï¼ˆSQLæœªæŒ‡å®šNOT NULLï¼‰ |
| create_time | DATETIME              | å¦    | CURRENT_TIMESTAMP | è®°å½•æ—¶é—´                   |

---

## å…­ã€åç«¯æ ¸å¿ƒæ¥å£è®¾è®¡ï¼ˆRESTfulè§„èŒƒï¼‰

### 1. ç”¨æˆ·æ¨¡å—

| æ–¹æ³•   | è·¯å¾„                        | æè¿°             |
|------|---------------------------|----------------|
| POST | `/api/user/register`      | ç”¨æˆ·æ³¨å†Œ           |
| POST | `/api/user/login`         | ç”¨æˆ·ç™»å½•ï¼Œè¿”å›JWT     |
| GET  | `/api/user/info`          | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼ˆéœ€JWTï¼‰ |
| POST | `/api/user/update`        | æ›´æ–°ç”¨æˆ·ä¿¡æ¯ï¼ˆæ˜µç§°ã€å¤´åƒç­‰ï¼‰ |
| POST | `/api/user/refresh-token` | åˆ·æ–°è®¿é—®ä»¤ç‰Œ         |
| POST | `/api/logout`             | ç”¨æˆ·ç™»å‡º           |
| GET  | `/api/user/{userId}`      | æ ¹æ®ç”¨æˆ·IDè·å–ç”¨æˆ·ä¿¡æ¯   |

### 2. å•†å“æ¨¡å—

| æ–¹æ³•   | è·¯å¾„                        | æè¿°                                     |
|------|---------------------------|----------------------------------------|
| POST | `/api/goods/publish`      | å‘å¸ƒæ–°å•†å“ï¼ˆmultipart/form-dataæ ¼å¼ï¼Œæ”¯æŒå›¾ç‰‡ä¸Šä¼ ï¼‰    |
| POST | `/api/goods/publish`      | å‘å¸ƒæ–°å•†å“ï¼ˆapplication/jsonæ ¼å¼ï¼Œçº¯æ•°æ®æäº¤ï¼‰        |
| GET  | `/api/goods/list`         | å•†å“åˆ†é¡µåˆ—è¡¨ï¼ˆæ”¯æŒpageNumã€pageSizeå‚æ•°ï¼Œé»˜è®¤ç¬¬1é¡µ10æ¡ï¼‰  |
| GET  | `/api/goods/detail/{id}`  | è·å–å•†å“è¯¦æƒ…                                 |
| GET  | `/api/goods/search`       | å…³é”®è¯æœç´¢å•†å“ï¼ˆæ”¯æŒpageNumã€pageSizeå‚æ•°ï¼Œé»˜è®¤ç¬¬1é¡µ10æ¡ï¼‰ |
| POST | `/api/goods/upload-image` | ä¸Šä¼ å•†å“å›¾ç‰‡ï¼Œè¿”å›å›¾ç‰‡è®¿é—®è·¯å¾„                        |

### 3. æ”¶è—æ¨¡å—

| æ–¹æ³•     | è·¯å¾„                     | æè¿°                                      |
|--------|------------------------|-----------------------------------------|
| POST   | `/api/favorite/add`    | æ·»åŠ æ”¶è—                                    |
| DELETE | `/api/favorite/remove` | å–æ¶ˆæ”¶è—ï¼ˆéœ€è¦goodsIdå‚æ•°ï¼‰                       |
| GET    | `/api/favorite/list`   | è·å–æˆ‘çš„æ”¶è—åˆ—è¡¨ï¼ˆæ”¯æŒpageNumã€pageSizeå‚æ•°ï¼Œé»˜è®¤ç¬¬1é¡µ10æ¡ï¼‰ |

### 4. ç•™è¨€æ¨¡å—

| æ–¹æ³•   | è·¯å¾„                               | æè¿°        |
|------|----------------------------------|-----------|
| POST | `/api/message/leave`             | å‘è¡¨ç•™è¨€      |
| POST | `/api/message/reply/{messageId}` | å›å¤ç•™è¨€      |
| GET  | `/api/message/list/{goodsId}`    | è·å–æŸå•†å“ç•™è¨€åˆ—è¡¨ |

### 5. è®¢å•æ¨¡å—

| æ–¹æ³•   | è·¯å¾„                  | æè¿°       |
|------|---------------------|----------|
| POST | `/api/order/create` | ç”Ÿæˆè®¢å•     |
| GET  | `/api/order/my`     | æˆ‘çš„è®¢å•åˆ—è¡¨## |

### 6. AIæ™ºèƒ½æœåŠ¡æ¨¡å—

| æ–¹æ³•   | è·¯å¾„             | æè¿°                 | è¯·æ±‚ä½“ç±»å‹           | å“åº”ä½“ç±»å‹            |
|------|----------------|--------------------|-----------------|------------------|
| POST | `/api/ai/chat` | å‘é€ç”¨æˆ·å¯¹è¯ï¼Œè·å–AIå›å¤åŠæ¨èå•†å“ | `AiChatRequest` | `AiChatResponse` |

#### è¯·æ±‚å‚æ•°ï¼ˆAiChatRequestï¼‰

| å‚æ•°å       | ç±»å‹     | æ˜¯å¦å¿…é¡» | æè¿°                     |
|-----------|--------|------|------------------------|
| userId    | Long   | æ˜¯    | ç”¨æˆ·ID                   |
| sessionId | String | å¦    | å¯¹è¯ä¼šè¯IDï¼ˆå¤šè½®å¯¹è¯æ ‡è¯†ï¼Œé¦–æ¬¡è°ƒç”¨å¯ä¸ä¼ ï¼‰ |
| message   | String | æ˜¯    | ç”¨æˆ·è¾“å…¥æ¶ˆæ¯å†…å®¹               |

è¯·æ±‚ç¤ºä¾‹ï¼š

```json
{
  "userId": 123,
  "sessionId": "uuid-xxxx-xxxx",
  "message": "æˆ‘æƒ³ä¹°ä¸€å°ä»·æ ¼åœ¨1000å…ƒå·¦å³çš„äºŒæ‰‹æ‰‹æœº"
}
```

#### å“åº”å‚æ•°ï¼ˆAiChatResponseï¼‰

| å‚æ•°å       | ç±»å‹      | æè¿°                 |
|-----------|---------|--------------------|
| reply     | String  | AIå›å¤æ–‡æœ¬å†…å®¹           |
| sessionId | String  | å½“å‰å¯¹è¯ä¼šè¯ID           |
| list      | Goods[] | æ¨èå•†å“åˆ—è¡¨ï¼ˆä¸ºç©ºæ—¶è¡¨ç¤ºæ— åŒ¹é…å•†å“ï¼‰ |

å“åº”ç¤ºä¾‹ï¼š

```json
{
  "code": 200,
  "message": "æˆåŠŸ",
  "data": {
    "reply": "æ ¹æ®æ‚¨çš„éœ€æ±‚ï¼Œæˆ‘æ¨èä»¥ä¸‹å‡ æ¬¾æ‰‹æœº...",
    "sessionId": "uuid-xxxx-xxxx",
    "list": [
      {
        "id": 12,
        "title": "äºŒæ‰‹iPhone 11",
        "price": 980.00,
        "image": "/uploads/iphone11.jpg"
      },
      {
        "id": 18,
        "title": "äºŒæ‰‹å°ç±³10",
        "price": 1050.00,
        "image": "/uploads/xiaomi10.jpg"
      }
    ]
  }
}
```

---

## ä¸ƒã€å‰ç«¯å®ç°è¯¦æƒ…

### ç‰¹è‰²åŠŸèƒ½ï¼šå›¾ç‰‡ä¸Šä¼ ç»„ä»¶

å•†å“å‘å¸ƒé¡µé¢(`Publish.vue`)å®ç°äº†å¤šå›¾ä¸Šä¼ åŠŸèƒ½ï¼Œæ”¯æŒä»¥ä¸‹ç‰¹æ€§ï¼š

- æœ€å¤šä¸Šä¼ 5å¼ å•†å“å›¾ç‰‡
- å›¾ç‰‡é¢„è§ˆã€åˆ é™¤ã€é‡è¯•ä¸Šä¼ åŠŸèƒ½
- ä¸Šä¼ è¿›åº¦æ˜¾ç¤º
- å›¾ç‰‡æ ¼å¼éªŒè¯(ä»…å…è®¸jpgã€pngæ ¼å¼)

### ç‰¹è‰²åŠŸèƒ½ï¼šAIæ¨èå®ç°ç»†èŠ‚

AIæ¨èåŠŸèƒ½é‡‡ç”¨æ··åˆæ¨èç­–ç•¥

1. **æ•°æ®åº“ä¼˜å…ˆæœç´¢**ï¼šæ¥æ”¶ç”¨æˆ·æŸ¥è¯¢åï¼Œé¦–å…ˆé€šè¿‡å…³é”®è¯æœç´¢å•†å“æ•°æ®åº“
2. **ç»“æœåˆ¤æ–­**ï¼šè‹¥æœç´¢åˆ°åŒ¹é…å•†å“(å¦‚ä»·æ ¼ã€ç±»åˆ«åŒ¹é…)ï¼Œç›´æ¥è¿”å›å•†å“æ¨è
3. **AIè°ƒç”¨é™çº§**ï¼šä»…å½“æ•°æ®åº“æœç´¢æ— ç»“æœæ—¶ï¼Œæ‰è°ƒç”¨DeepSeek APIè·å–AIç”Ÿæˆçš„æ¨èå†…å®¹

å¢å¼ºç”¨æˆ·ä½“éªŒ

- AIå›å¤ç­‰å¾…æ—¶çš„æ¶ˆæ¯æ°”æ³¡åŠ¨ç”»å’Œloadingé—ªç‚¹æ•ˆæœï¼Œè¥é€ AIâ€œæ€è€ƒâ€çš„è§†è§‰ä½“éªŒ

#### AIèŠå¤©æ¥å£å°è£…

å‰ç«¯é€šè¿‡`src/api/ai.ts`å°è£…AIæœåŠ¡ç›¸å…³æ¥å£

**åŠŸèƒ½è¯´æ˜**ï¼š

- `sendAiChatMessage`ï¼šå‘é€ç”¨æˆ·å¯¹è¯å†…å®¹åˆ°åç«¯AIæœåŠ¡æ¥å£ï¼Œæ”¯æŒå¤šè½®å¯¹è¯ï¼ˆé€šè¿‡sessionIdæ ‡è¯†ï¼‰

### UIæ¡†æ¶ä¸è®¾è®¡

é¡¹ç›®é‡‡ç”¨Element Plusä½œä¸ºä¸»è¦UIç»„ä»¶åº“ï¼Œå®ç°äº†ç»Ÿä¸€çš„è®¾è®¡è¯­è¨€å’Œå“åº”å¼å¸ƒå±€ï¼ŒåŒ…æ‹¬ï¼š

- ç®€çº¦ä¸»é¢˜é…è‰²æ–¹æ¡ˆï¼Œç¬¦åˆäºŒæ‰‹äº¤æ˜“å¹³å°æ¸…çˆ½çš„è§†è§‰å®šä½
- å“åº”å¼å¸ƒå±€è®¾è®¡ï¼Œé€‚é…æ¡Œé¢ç«¯ä¸ç§»åŠ¨ç«¯æµè§ˆ
- ç»Ÿä¸€çš„å¡ç‰‡å¼ç»„ä»¶è®¾è®¡ï¼Œç”¨äºå•†å“å±•ç¤ºã€ç”¨æˆ·ä¿¡æ¯ç­‰æ¨¡å—
- äº¤äº’åŠ¨æ•ˆä¼˜åŒ–ï¼ŒåŒ…æ‹¬æŒ‰é’®æ‚¬åœæ•ˆæœã€é¡µé¢è¿‡æ¸¡åŠ¨ç”»å’ŒåŠ è½½çŠ¶æ€åé¦ˆ

### 1. çŠ¶æ€ç®¡ç†

é¡¹ç›®ä½¿ç”¨ Pinia è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Œé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œä¸»è¦ store æ–‡ä»¶åŠæ ¸å¿ƒåŠŸèƒ½å¦‚ä¸‹ï¼š

#### æ ¸å¿ƒ Store

- `store/user.ts`: ç”¨æˆ·çŠ¶æ€ç®¡ç†
    - çŠ¶æ€ï¼š`userInfo`ï¼ˆç”¨æˆ·ä¿¡æ¯ï¼‰ã€`accessToken`ï¼ˆè®¿é—®ä»¤ç‰Œï¼‰ã€`isLogin`ï¼ˆç™»å½•çŠ¶æ€ï¼‰
    - æ ¸å¿ƒæ–¹æ³•ï¼š`login()`ã€`logout()`ã€`fetchUserInfo()`ã€`refreshToken()`

- `store/goods.ts`: å•†å“çŠ¶æ€ç®¡ç†
    - çŠ¶æ€ï¼š`goodsList`ï¼ˆå•†å“åˆ—è¡¨ï¼‰ã€`currentGoods`ï¼ˆå½“å‰å•†å“è¯¦æƒ…ï¼‰ã€`total`ï¼ˆå•†å“æ€»æ•°ï¼‰
    - æ ¸å¿ƒæ–¹æ³•ï¼š`fetchGoodsList()`ã€`searchGoods()`ã€`fetchGoodsDetail()`

- `store/ai.ts`: AIæœåŠ¡çŠ¶æ€ç®¡ç†
    - æ ¸å¿ƒæ–¹æ³•ï¼š
        - `sendMessage(content: string)`: å‘é€æ¶ˆæ¯å¹¶å¤„ç†AIå“åº”
        - `clearHistory()`: æ¸…é™¤èŠå¤©å†å²
        - `fetchHistory()`: è·å–å†å²è®°å½•ï¼ˆæœ¬åœ°æ¨¡æ‹Ÿï¼‰

- `store/favorite.ts`: æ”¶è—çŠ¶æ€ç®¡ç†
- `store/message.ts`: ç•™è¨€çŠ¶æ€ç®¡ç†
- `store/order.ts`: è®¢å•çŠ¶æ€ç®¡ç†

#### çŠ¶æ€ç®¡ç†æµç¨‹ç¤ºä¾‹ï¼ˆAIå¯¹è¯ï¼‰

1. ç”¨æˆ·è¾“å…¥æ¶ˆæ¯ â†’ è°ƒç”¨ `aiStore.sendMessage()`
2. å­˜å‚¨ç”¨æˆ·æ¶ˆæ¯åˆ° `messages` æ•°ç»„
3. è°ƒç”¨APIè·å–AIå“åº” â†’ æ›´æ–° `messages` å’Œ `recommendedGoods`
4. ç»„ä»¶é€šè¿‡ `useAiStore()` è·å–çŠ¶æ€å¹¶æ¸²æŸ“ç•Œé¢

### 2. æ ¸å¿ƒé¡µé¢ç»„ä»¶

- `views/Home.vue`: é¦–é¡µï¼Œå±•ç¤ºå•†å“åˆ—è¡¨åŠæœç´¢åŠŸèƒ½
- `views/GoodsDetail.vue`: å•†å“è¯¦æƒ…é¡µ
- `views/Publish.vue`: å•†å“å‘å¸ƒé¡µ
- `views/Login.vue`: ç™»å½•æ³¨å†Œé¡µ
- `views/UserCenter.vue`: ç”¨æˆ·ä¸­å¿ƒï¼ŒåŒ…å«æˆ‘çš„å‘å¸ƒã€æ”¶è—ã€è®¢å•ç­‰
- `views/Favorites.vue`: æˆ‘çš„æ”¶è—é¡µé¢

### 3. API è¯·æ±‚

æ‰€æœ‰ API è¯·æ±‚é€šè¿‡ `src/api/request.ts` å°è£…çš„ Axios å®ä¾‹å®ç°ï¼ŒåŒ…å«è¯·æ±‚/å“åº”æ‹¦æˆªå™¨ç»Ÿä¸€å¤„ç†ï¼š

#### è¯·æ±‚æ‹¦æˆªå™¨

è‡ªåŠ¨æ·»åŠ  Authorization è¯·æ±‚å¤´ï¼ˆBearer Tokenï¼‰ï¼Œå®ç° JWT èº«ä»½éªŒè¯

#### å“åº”æ‹¦æˆªå™¨

ç»Ÿä¸€é”™è¯¯å¤„ç†ï¼ŒåŒ…å« 401/403 æƒé™é”™è¯¯å¤„ç†å’Œè‡ªåŠ¨ç™»å‡ºé€»è¾‘ã€‚

#### æ¥å£æ¨¡å—åˆ’åˆ†

æ‰€æœ‰ API è¯·æ±‚å°è£…åœ¨ `src/api/` ç›®å½•ä¸‹ï¼ŒæŒ‰åŠŸèƒ½æ¨¡å—åˆ’åˆ†ï¼š

- `api/user.ts`: ç”¨æˆ·ç›¸å…³æ¥å£
- `api/goods.ts`: å•†å“ç›¸å…³æ¥å£
- `api/favorite.ts`: æ”¶è—ç›¸å…³æ¥å£
- `api/message.ts`: ç•™è¨€ç›¸å…³æ¥å£
- `api/order.ts`: è®¢å•ç›¸å…³æ¥å£

### 4. åº”ç”¨åˆå§‹åŒ–é…ç½®

åº”ç”¨å…¥å£æ–‡ä»¶ `src/main.ts` è´Ÿè´£åˆå§‹åŒ– Vue åº”ç”¨å¹¶é›†æˆæ ¸å¿ƒä¾èµ–

### 5. è·¯ç”±é…ç½®

è·¯ç”±é…ç½®åœ¨ `src/router/index.ts` æ–‡ä»¶ä¸­ï¼Œé‡‡ç”¨ Vue Router è¿›è¡Œè·¯ç”±ç®¡ç†ï¼Œå®ç°äº†é¡µé¢é—´çš„å¯¼èˆªå’Œæƒé™æ§åˆ¶ã€‚ä¸»è¦è·¯ç”±å®šä¹‰å¦‚ä¸‹ï¼š

| è·¯å¾„                  | ç»„ä»¶                      | è¯´æ˜     | æƒé™è¦æ±‚ |
|---------------------|-------------------------|--------|------|
| `/`                 | `pages/Home.vue`        | é¦–é¡µ     | æ— éœ€ç™»å½• |
| `/login`            | `pages/Login.vue`       | ç™»å½•é¡µ    | æ— éœ€ç™»å½• |
| `/register`         | `pages/Register.vue`    | æ³¨å†Œé¡µ    | æ— éœ€ç™»å½• |
| `/user-center`      | `pages/UserCenter.vue`  | ç”¨æˆ·ä¸­å¿ƒä¸»é¡µ | éœ€è¦ç™»å½• |
| `/goods/detail/:id` | `pages/GoodsDetail.vue` | å•†å“è¯¦æƒ…é¡µ  | éœ€è¦ç™»å½• |
| `/publish`          | `pages/Publish.vue`     | å•†å“å‘å¸ƒé¡µ  | éœ€è¦ç™»å½• |
| `/user/profile`     | `views/UserProfile.vue` | ç”¨æˆ·èµ„æ–™é¡µ  | éœ€è¦ç™»å½• |
| `/favorites`        | `views/Favorites.vue`   | æˆ‘çš„æ”¶è—é¡µ  | éœ€è¦ç™»å½• |
| `/orders`           | `views/OrderList.vue`   | æˆ‘çš„è®¢å•é¡µ  | éœ€è¦ç™»å½• |

**è·¯ç”±å®ˆå«å®ç°**ï¼šç³»ç»Ÿé€šè¿‡å…¨å±€è·¯ç”±å®ˆå«æ§åˆ¶é¡µé¢è®¿é—®æƒé™ï¼Œæœªç™»å½•ç”¨æˆ·è®¿é—®éœ€è¦æˆæƒçš„é¡µé¢æ—¶ä¼šè‡ªåŠ¨é‡å®šå‘åˆ°ç™»å½•é¡µã€‚æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š

```typescript
// è·¯ç”±å®ˆå«å®ç°
router.beforeEach((to, _from, next) => {
    const token = localStorage.getItem('accessToken')
    // ä¸éœ€è¦ç™»å½•çš„é¡µé¢
    const publicPages = ['/login', '/register']
    const requiresAuth = !publicPages.includes(to.path)

    if (requiresAuth && !token) {
        next('/login')
    } else {
        next()
    }
})
```

## å…«ã€è¿è¡Œä¸å¼€å‘è¯´æ˜

### ç³»ç»Ÿé…ç½®è¡¥å……

#### åç«¯é…ç½®(`application.yml`)

```yaml
# æ•°æ®åº“é…ç½®
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/secondhand?useUnicode=true&characterEncoding=UTF-8&useSSL=false&serverTimezone=Asia/Shanghai
    username: root
    password: 123456
    driver-class-name: com.mysql.cj.jdbc.Driver
  # Redisé…ç½®
  data:
    redis:
      port: 6379
      password: 123456
      host: localhost
  # AIæœåŠ¡é…ç½®
  ai:
    deepseek:
      api-key: å¡«å…¥è·å–åˆ°çš„Key
      endpoint: "https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation"

# æ–‡ä»¶ä¸Šä¼ é…ç½®
upload:
  path: "d:/SecondhandSystem/uploads/"

# JWTé…ç½®
jwt:
  secret: secondhand_system_jwt_secret_key_2025
  expiration: 86400000
```

### åç«¯å¯åŠ¨

1. é…ç½® `application.yml`ï¼ˆæ•°æ®åº“ã€Redisã€OSSã€AIæœåŠ¡æ¨¡æ‹Ÿå‚æ•°ï¼‰

2. å¯¼å…¥æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼ˆ`secondhand_backend/src/main/resources/sql/init.sql`ï¼‰åˆå§‹åŒ–æ•°æ®åº“

3. å¯åŠ¨ Spring Boot é¡¹ç›®ï¼š

```bash
cd secondhand_backend
mvn clean package
java -jar target/second-hand-market-1.0.jar
```

### å‰ç«¯å¯åŠ¨

1. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆä½äºå‰ç«¯æ ¹ç›®å½• `.env` æ–‡ä»¶ï¼‰ï¼š
   ```
   VITE_APP_API_URL=http://localhost:7272/api  # åç«¯APIåŸºç¡€åœ°å€
   VITE_APP_BASE_URL=http://localhost:7272     # åç«¯åŸºç¡€åœ°å€
   ```
   æ ¹æ®å®é™…åç«¯æœåŠ¡åœ°å€ä¿®æ”¹ä¸Šè¿°å€¼

2. å¯åŠ¨å‰ç«¯é¡¹ç›®ï¼š

```bash
cd secondhand_frontend
npm install
npm run dev
```

---

## å…«ã€APIæ–‡æ¡£ï¼ˆOpenapiï¼‰

> è®¿é—®åœ°å€ï¼š

```
http://localhost:7272/doc.html
```

---

## ä½œè€…ä¿¡æ¯

- Author: [River Xue]

- GitHub: [RiverXue Â· GitHub](https://github.com/RiverXue)

---
