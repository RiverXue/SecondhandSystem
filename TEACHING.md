# AI智能服务模块演讲稿

## 一、模块介绍

AI智能服务模块是二手交易平台的核心功能之一，旨在为用户提供智能化的商品推荐和交互体验。该模块允许用户通过聊天窗口与AI助手进行自然语言对话，AI根据用户需求推荐合适的二手商品，并支持多轮对话以优化推荐结果。

## 二、页面功能

AI智能服务模块的主要界面是一个聊天对话框，包含以下功能区域：

1. **聊天窗口**：显示用户与AI的对话历史，区分用户消息和AI回复
2. **输入区域**：提供文本输入框供用户输入查询内容
3. **发送按钮**：提交用户输入的消息
4. **加载状态**：显示AI处理请求的加载动画
5. **推荐商品展示区**：在AI回复后展示相关商品推荐

## 三、组件与脚本

### 前端组件

1. **AiChat.vue**：核心聊天组件，使用Element Plus的`el-dialog`作为容器，`el-scrollbar`实现消息列表滚动，自定义`message-item`
   组件展示对话内容

2. **状态管理**：
    - 使用Pinia存储聊天状态（`store/ai.ts`）
    - 管理会话ID（`sessionId`）、消息列表（`messages`）、加载状态（`isLoading`）和推荐商品（`recommendedGoods`）

3. **API调用**：
    - `api/ai.ts`中的`sendAiChatMessage`函数负责与后端通信
    - 传递用户ID、会话ID和消息内容到后端接口

### 核心脚本逻辑

1. **消息发送流程**：
    - 用户输入消息后添加到本地消息列表
    - 调用AI接口发送消息内容
    - 接收AI回复并更新消息列表
    - 处理推荐商品数据并展示

2. **会话管理**：
    - 首次对话自动生成会话ID
    - 保持会话ID实现多轮对话
    - 根据后端返回更新会话状态

## 四、前后端关键代码讲解

### 后端实现

1. **数据模型**：
    - `AiChat`实体类存储对话记录，包含用户ID、会话ID、消息内容、AI回复和创建时间
    - 使用MyBatis-Plus进行数据库操作

2. **AI服务配置**：
    - 在`application.yml`中配置DeepSeek API密钥和端点
    - 设置API调用参数和超时控制

3. **业务逻辑**：
    - 接收前端请求，处理用户消息
    - 调用第三方AI服务获取回复
    - 存储对话记录到数据库
    - 分析AI回复提取商品推荐信息

### 前端实现

1. **聊天状态管理**：
    - 使用Vuex管理全局聊天状态
    - 实现消息的添加、删除和更新
    - 控制加载状态和错误处理

2. **消息渲染**：
    - 区分用户和AI消息的样式
    - 支持Markdown格式的AI回复
    - 动态渲染推荐商品列表

3. **用户交互**：
    - 处理输入框的回车提交
    - 限制消息长度（200字符）
    - 显示字数统计和提交状态

## 五、总结

AI智能服务模块通过自然语言交互提升了用户体验，帮助用户快速找到合适的二手商品。前端使用Vue+Element Plus构建响应式界面，后端通过Spring
Boot集成第三方AI服务，实现了一个功能完整、交互友好的智能推荐系统。